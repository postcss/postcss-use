/* eslint-disable strict, prefer-arrow-callback, no-var */
'use strict';

var postcss = require('postcss');

module.exports = postcss.plugin('nobg', function (opts) {
    var options = opts || {};
    return function nobg (css) {
        var matchers = [/^background/];
        // Let's pretend this is a new release which has to support an
        // earlier API where you explicitly defined declarations
        if (Array.isArray(options)) {
            matchers = options.map(function (decl) {
                return new RegExp('^' + decl + '$');
            });
        } else if (options.onlyImages) {
            matchers = [/^background-image/];
        }

        matchers.forEach(function (matcher) {
            css.walkDecls(matcher, function (decl) {
                decl.remove();
            });
        });
    };
});
