/* eslint-disable strict, prefer-arrow-callback, no-var */
'use strict';

module.exports = function (opts) {
    var options = opts || {};
    return {
        postcssPlugin: 'postcss-nobg',
        Once (root) {
            var matchers = [/^background/];
            // Let's pretend this is a new release which has to support an
            // earlier API where you explicitly defined declarations
            if (Array.isArray(options)) {
                matchers = options.map(function (decl) {
                    return new RegExp('^' + decl + '$');
                });
            } else if (options.onlyImages) {
                matchers = [/^background-image/];
            }

            matchers.forEach(function (matcher) {
                root.walkDecls(matcher, function (decl) {
                    decl.remove();
                });
            });
        },
    };
};
module.exports.postcss = true;
